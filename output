. ../.venv/bin/activate && \
	 pytest --cov-append --cov=sigstore test/unit test/integration -rs -vv && \
	python -m coverage report -m 
[1m========================================================================================================================= test session starts ==========================================================================================================================[0m
platform linux -- Python 3.13.2, pytest-8.4.0, pluggy-1.6.0 -- /usr/local/google/home/rpetgrave/workspaces/rekorv2/.venv/bin/python
cachedir: .pytest_cache
rootdir: /usr/local/google/home/rpetgrave/workspaces/rekorv2/sigstore-python
configfile: pyproject.toml
plugins: cov-6.2.1
[1mcollecting ... [0m[1mcollected 215 items                                                                                                                                                                                                                                                    [0m

test/unit/internal/oidc/test_issuer.py::test_fail_init_url [32mPASSED[0m[32m                                                                                                                                                                                                [  0%][0m
test/unit/internal/oidc/test_issuer.py::test_init_url [32mPASSED[0m[32m                                                                                                                                                                                                     [  0%][0m
test/unit/internal/oidc/test_issuer.py::test_get_identity_token_bad_code [32mPASSED[0m[32m                                                                                                                                                                                  [  1%][0m
test/unit/internal/test_sct.py::test_pack_digitally_signed_precertificate[3] [32mPASSED[0m[32m                                                                                                                                                                              [  1%][0m
test/unit/internal/test_sct.py::test_pack_digitally_signed_precertificate[255] [32mPASSED[0m[32m                                                                                                                                                                            [  2%][0m
test/unit/internal/test_sct.py::test_pack_digitally_signed_precertificate[1024] [32mPASSED[0m[32m                                                                                                                                                                           [  2%][0m
test/unit/internal/test_sct.py::test_pack_digitally_signed_precertificate[16777215] [32mPASSED[0m[32m                                                                                                                                                                       [  3%][0m
test/unit/internal/test_timestamping.py::TestTimestampAuthorityClient::test_sign_request [33mSKIPPED[0m (skipping test that requires a Timestamp Authority)[32m                                                                                                             [  3%][0m
test/unit/internal/test_timestamping.py::TestTimestampAuthorityClient::test_sign_request_invalid_url [33mSKIPPED[0m (skipping test that requires a Timestamp Authority)[32m                                                                                                 [  4%][0m
test/unit/internal/test_timestamping.py::TestTimestampAuthorityClient::test_sign_request_invalid_request [33mSKIPPED[0m (skipping test that requires a Timestamp Authority)[32m                                                                                             [  4%][0m
test/unit/internal/test_timestamping.py::TestTimestampAuthorityClient::test_invalid_response [33mSKIPPED[0m (skipping test that requires a Timestamp Authority)[32m                                                                                                         [  5%][0m
test/unit/internal/test_trust.py::TestCertificateAuthority::test_good [32mPASSED[0m[32m                                                                                                                                                                                     [  5%][0m
test/unit/internal/test_trust.py::TestCertificateAuthority::test_missing_root [32mPASSED[0m[32m                                                                                                                                                                             [  6%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_good [32mPASSED[0m[32m                                                                                                                                                                                           [  6%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services[base case] [32mPASSED[0m[32m                                                                                                                                                                  [  6%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services[multiple services, same operator: expect 1 service in result] [32mPASSED[0m[32m                                                                                                               [  7%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services[2 services, different operator: expect 2 services in result] [32mPASSED[0m[32m                                                                                                                [  7%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services[3 services, one is not yet valid: expect 2 services in result] [32mPASSED[0m[32m                                                                                                              [  8%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services[ANY selector: expect 1 service only in result] [32mPASSED[0m[32m                                                                                                                              [  8%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services[EXACT selector: expect configured number of services in result] [32mPASSED[0m[32m                                                                                                             [  9%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services[services with different version: expect highest version] [32mPASSED[0m[32m                                                                                                                    [  9%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services[services with different version: expect the supported version] [32mPASSED[0m[32m                                                                                                              [ 10%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services[No supported versions: expect no results] [32mPASSED[0m[32m                                                                                                                                   [ 10%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services[services without ServiceConfiguration: expect all supported] [32mPASSED[0m[32m                                                                                                                [ 11%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services_fail[services0-versions0-config0] [32mPASSED[0m[32m                                                                                                                                           [ 11%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services_fail[services1-versions1-config1] [32mPASSED[0m[32m                                                                                                                                           [ 12%][0m
test/unit/internal/test_trust.py::TestSigningcconfig::test_get_valid_services_fail[services2-versions2-config2] [32mPASSED[0m[32m                                                                                                                                           [ 12%][0m
test/unit/internal/test_trust.py::TestTrustedRoot::test_good[trusted_root/trustedroot.v1.json] [32mPASSED[0m[32m                                                                                                                                                            [ 13%][0m
test/unit/internal/test_trust.py::TestTrustedRoot::test_good[trusted_root/trustedroot.v1.local_tlog_ed25519_rekor-tiles.json] [32mPASSED[0m[33m                                                                                                                             [ 13%][0m
test/unit/internal/test_trust.py::TestTrustedRoot::test_bad_media_type [32mPASSED[0m[33m                                                                                                                                                                                    [ 13%][0m
test/unit/internal/test_trust.py::test_trust_root_tuf_caches_and_requests [32mPASSED[0m[33m                                                                                                                                                                                 [ 14%][0m
test/unit/internal/test_trust.py::test_trust_root_tuf_offline [32mPASSED[0m[33m                                                                                                                                                                                             [ 14%][0m
test/unit/internal/test_trust.py::test_is_timerange_valid [32mPASSED[0m[33m                                                                                                                                                                                                 [ 15%][0m
test/unit/internal/test_trust.py::test_trust_root_bundled_get [32mPASSED[0m[33m                                                                                                                                                                                             [ 15%][0m
test/unit/internal/test_trust.py::test_trust_root_tuf_instance_error [32mPASSED[0m[33m                                                                                                                                                                                      [ 16%][0m
test/unit/internal/test_trust.py::test_trust_root_tuf_ctfe_keys_error [32mPASSED[0m[33m                                                                                                                                                                                     [ 16%][0m
test/unit/internal/test_trust.py::test_trust_root_fulcio_certs_error [32mPASSED[0m[33m                                                                                                                                                                                      [ 17%][0m
test/unit/internal/test_trust.py::TestClientTrustConfig::test_good [32mPASSED[0m[33m                                                                                                                                                                                        [ 17%][0m
test/unit/internal/test_trust.py::TestClientTrustConfig::test_bad_media_type [32mPASSED[0m[33m                                                                                                                                                                              [ 18%][0m
test/unit/test_dsse.py::TestEnvelope::test_roundtrip [32mPASSED[0m[33m                                                                                                                                                                                                      [ 18%][0m
test/unit/test_dsse.py::TestEnvelope::test_missing_signature [32mPASSED[0m[33m                                                                                                                                                                                              [ 19%][0m
test/unit/test_dsse.py::TestEnvelope::test_empty_signature [32mPASSED[0m[33m                                                                                                                                                                                                [ 19%][0m
test/unit/test_dsse.py::TestEnvelope::test_multiple_signatures [32mPASSED[0m[33m                                                                                                                                                                                            [ 20%][0m
test/unit/test_hashes.py::TestHashes::test_hashed_repr[SHA2_256-e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855] [32mPASSED[0m[33m                                                                                                                         [ 20%][0m
test/unit/test_hashes.py::TestHashes::test_hashed_repr[SHA2_384-38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da274edebfe76f65fbd51ad2f14898b95b] [32mPASSED[0m[33m                                                                                         [ 20%][0m
test/unit/test_hashes.py::TestHashes::test_hashed_repr[SHA2_512-cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e] [32mPASSED[0m[33m                                                         [ 21%][0m
test/unit/test_hashes.py::TestHashes::test_hashed_repr[SHA3_256-a7ffc6f8bf1ed76651c14756a061d662f580ff4de43b49fa82d80a4b80f8434a] [32mPASSED[0m[33m                                                                                                                         [ 21%][0m
test/unit/test_hashes.py::TestHashes::test_hashed_repr[SHA3_384-0c63a75b845e4f7d01107d852e4c2485c51a50aaaa94fc61995e71bbee983a2ac3713831264adb47fb6bd1e058d5f004] [32mPASSED[0m[33m                                                                                         [ 22%][0m
test/unit/test_models.py::TestLogEntry::test_missing_inclusion_proof[0] [32mPASSED[0m[33m                                                                                                                                                                                   [ 22%][0m
test/unit/test_models.py::TestLogEntry::test_missing_inclusion_proof[1746819403] [32mPASSED[0m[33m                                                                                                                                                                          [ 23%][0m
test/unit/test_models.py::TestLogEntry::test_missing_inclusion_promise_and_integrated_time_round_trip [32mPASSED[0m[33m                                                                                                                                                     [ 23%][0m
test/unit/test_models.py::TestLogEntry::test_logentry_roundtrip [32mPASSED[0m[33m                                                                                                                                                                                           [ 24%][0m
test/unit/test_models.py::TestLogInclusionProof::test_valid [32mPASSED[0m[33m                                                                                                                                                                                               [ 24%][0m
test/unit/test_models.py::TestLogInclusionProof::test_negative_log_index [32mPASSED[0m[33m                                                                                                                                                                                  [ 25%][0m
test/unit/test_models.py::TestLogInclusionProof::test_negative_tree_size [32mPASSED[0m[33m                                                                                                                                                                                  [ 25%][0m
test/unit/test_models.py::TestLogInclusionProof::test_log_index_outside_tree_size [32mPASSED[0m[33m                                                                                                                                                                         [ 26%][0m
test/unit/test_models.py::TestLogInclusionProof::test_checkpoint_missing [32mPASSED[0m[33m                                                                                                                                                                                  [ 26%][0m
test/unit/test_models.py::TestTimestampVerificationData::test_valid_timestamp [32mPASSED[0m[33m                                                                                                                                                                             [ 26%][0m
test/unit/test_models.py::TestTimestampVerificationData::test_no_timestamp [32mPASSED[0m[33m                                                                                                                                                                                [ 27%][0m
test/unit/test_models.py::TestTimestampVerificationData::test_invalid_timestamp [32mPASSED[0m[33m                                                                                                                                                                           [ 27%][0m
test/unit/test_models.py::TestVerificationMaterial::test_valid_verification_material [32mPASSED[0m[33m                                                                                                                                                                      [ 28%][0m
test/unit/test_models.py::TestBundle::test_invalid_bundle_version [32mPASSED[0m[33m                                                                                                                                                                                         [ 28%][0m
test/unit/test_models.py::TestBundle::test_invalid_empty_cert_chain [32mPASSED[0m[33m                                                                                                                                                                                       [ 29%][0m
test/unit/test_models.py::TestBundle::test_invalid_no_log_entry [32mPASSED[0m[33m                                                                                                                                                                                           [ 29%][0m
test/unit/test_models.py::TestBundle::test_verification_materials_offline_no_checkpoint [32mPASSED[0m[33m                                                                                                                                                                   [ 30%][0m
test/unit/test_models.py::TestBundle::test_bundle_roundtrip [32mPASSED[0m[33m                                                                                                                                                                                               [ 30%][0m
test/unit/test_models.py::TestBundle::test_bundle_missing_signed_time [32mPASSED[0m[33m                                                                                                                                                                                     [ 31%][0m
test/unit/test_models.py::TestKnownBundleTypes::test_str [32mPASSED[0m[33m                                                                                                                                                                                                  [ 31%][0m
test/unit/test_oidc.py::TestIdentityToken::test_invalid_jwt [32mPASSED[0m[33m                                                                                                                                                                                               [ 32%][0m
test/unit/test_oidc.py::TestIdentityToken::test_missing_iss [32mPASSED[0m[33m                                                                                                                                                                                               [ 32%][0m
test/unit/test_oidc.py::TestIdentityToken::test_missing_aud [32mPASSED[0m[33m                                                                                                                                                                                               [ 33%][0m
test/unit/test_oidc.py::TestIdentityToken::test_invalid_aud[None] [32mPASSED[0m[33m                                                                                                                                                                                         [ 33%][0m
test/unit/test_oidc.py::TestIdentityToken::test_invalid_aud[not-sigstore] [32mPASSED[0m[33m                                                                                                                                                                                 [ 33%][0m
test/unit/test_oidc.py::TestIdentityToken::test_missing_iat [32mPASSED[0m[33m                                                                                                                                                                                               [ 34%][0m
test/unit/test_oidc.py::TestIdentityToken::test_invalid_iat[None] [32mPASSED[0m[33m                                                                                                                                                                                         [ 34%][0m
test/unit/test_oidc.py::TestIdentityToken::test_invalid_iat[not-an-int] [32mPASSED[0m[33m                                                                                                                                                                                   [ 35%][0m
test/unit/test_oidc.py::TestIdentityToken::test_missing_nbf_ok [32mPASSED[0m[33m                                                                                                                                                                                            [ 35%][0m
test/unit/test_oidc.py::TestIdentityToken::test_invalid_nbf [32mPASSED[0m[33m                                                                                                                                                                                               [ 36%][0m
test/unit/test_oidc.py::TestIdentityToken::test_missing_exp [32mPASSED[0m[33m                                                                                                                                                                                               [ 36%][0m
test/unit/test_oidc.py::TestIdentityToken::test_invalid_exp [32mPASSED[0m[33m                                                                                                                                                                                               [ 37%][0m
test/unit/test_oidc.py::TestIdentityToken::test_missing_identity_claim[https://accounts.google.com] [32mPASSED[0m[33m                                                                                                                                                       [ 37%][0m
test/unit/test_oidc.py::TestIdentityToken::test_missing_identity_claim[https://oauth2.sigstore.dev/auth] [32mPASSED[0m[33m                                                                                                                                                  [ 38%][0m
test/unit/test_oidc.py::TestIdentityToken::test_missing_identity_claim[https://oauth2.sigstage.dev/auth] [32mPASSED[0m[33m                                                                                                                                                  [ 38%][0m
test/unit/test_oidc.py::TestIdentityToken::test_invalid_federated_claims[notadict] [32mPASSED[0m[33m                                                                                                                                                                        [ 39%][0m
test/unit/test_oidc.py::TestIdentityToken::test_invalid_federated_claims[fed1] [32mPASSED[0m[33m                                                                                                                                                                            [ 39%][0m
test/unit/test_oidc.py::TestIdentityToken::test_ok[https://accounts.google.com-email-example@example.com-None] [32mPASSED[0m[33m                                                                                                                                            [ 40%][0m
test/unit/test_oidc.py::TestIdentityToken::test_ok[https://oauth2.sigstore.dev/auth-email-example@example.com-https://accounts.google.com] [32mPASSED[0m[33m                                                                                                                [ 40%][0m
test/unit/test_oidc.py::TestIdentityToken::test_ok[https://oauth2.sigstore.dev/auth-email-example@example.com-None] [32mPASSED[0m[33m                                                                                                                                       [ 40%][0m
test/unit/test_oidc.py::TestIdentityToken::test_ok[https://token.actions.githubusercontent.com-sub-some-subject-None] [32mPASSED[0m[33m                                                                                                                                     [ 41%][0m
test/unit/test_oidc.py::TestIdentityToken::test_ok[hxxps://unknown.issuer.example.com/auth-sub-some-subject-None] [32mPASSED[0m[33m                                                                                                                                         [ 41%][0m
test/unit/test_sign.py::test_sign_rekor_entry_consistent[staging] [32mPASSED[0m[33m                                                                                                                                                                                         [ 42%][0m
test/unit/test_sign.py::test_sign_rekor_entry_consistent[production] [32mPASSED[0m[33m                                                                                                                                                                                      [ 42%][0m
test/unit/test_sign.py::test_sign_rekor_entry_consistent[local] [32mPASSED[0m[33m                                                                                                                                                                                           [ 43%][0m
test/unit/test_sign.py::test_sct_verify_keyring_lookup_error[staging] [32mPASSED[0m[33m                                                                                                                                                                                     [ 43%][0m
test/unit/test_sign.py::test_sct_verify_keyring_lookup_error[production] [32mPASSED[0m[33m                                                                                                                                                                                  [ 44%][0m
test/unit/test_sign.py::test_sct_verify_keyring_lookup_error[local] [32mPASSED[0m[33m                                                                                                                                                                                       [ 44%][0m
test/unit/test_sign.py::test_sct_verify_keyring_error[staging] [32mPASSED[0m[33m                                                                                                                                                                                            [ 45%][0m
test/unit/test_sign.py::test_sct_verify_keyring_error[production] [32mPASSED[0m[33m                                                                                                                                                                                         [ 45%][0m
test/unit/test_sign.py::test_sct_verify_keyring_error[local] [32mPASSED[0m[33m                                                                                                                                                                                              [ 46%][0m
test/unit/test_sign.py::test_identity_proof_claim_lookup[staging] [32mPASSED[0m[33m                                                                                                                                                                                         [ 46%][0m
test/unit/test_sign.py::test_identity_proof_claim_lookup[production] [32mPASSED[0m[33m                                                                                                                                                                                      [ 46%][0m
test/unit/test_sign.py::test_identity_proof_claim_lookup[local] [32mPASSED[0m[33m                                                                                                                                                                                           [ 47%][0m
test/unit/test_sign.py::test_sign_prehashed[preprod-staging] [32mPASSED[0m[33m                                                                                                                                                                                              [ 47%][0m
test/unit/test_sign.py::test_sign_prehashed[preprod-local] [32mPASSED[0m[33m                                                                                                                                                                                                [ 48%][0m
test/unit/test_sign.py::test_sign_dsse[preprod-staging] [32mPASSED[0m[33m                                                                                                                                                                                                   [ 48%][0m
test/unit/test_sign.py::test_sign_dsse[preprod-local] [32mPASSED[0m[33m                                                                                                                                                                                                     [ 49%][0m
test/unit/test_sign.py::TestSignWithTSA::test_sign_artifact[preprod-staging] [33mSKIPPED[0m (skipping test that requires a Timestamp Authority)[33m                                                                                                                         [ 49%][0m
test/unit/test_sign.py::TestSignWithTSA::test_sign_artifact[preprod-local] [33mSKIPPED[0m (skipping test that requires a Timestamp Authority)[33m                                                                                                                           [ 50%][0m
test/unit/test_sign.py::TestSignWithTSA::test_sign_dsse[preprod-staging] [33mSKIPPED[0m (skipping test that requires a Timestamp Authority)[33m                                                                                                                             [ 50%][0m
test/unit/test_sign.py::TestSignWithTSA::test_sign_dsse[preprod-local] [33mSKIPPED[0m (skipping test that requires a Timestamp Authority)[33m                                                                                                                               [ 51%][0m
test/unit/test_sign.py::TestSignWithTSA::test_with_timestamp_error[preprod-staging] [33mSKIPPED[0m (skipping test that requires a Timestamp Authority)[33m                                                                                                                  [ 51%][0m
test/unit/test_sign.py::TestSignWithTSA::test_with_timestamp_error[preprod-local] [33mSKIPPED[0m (skipping test that requires a Timestamp Authority)[33m                                                                                                                    [ 52%][0m
test/unit/test_store.py::test_store_reads_root_json[https://tuf-repo-cdn.sigstore.dev] [32mPASSED[0m[33m                                                                                                                                                                    [ 52%][0m
test/unit/test_store.py::test_store_reads_root_json[https://tuf-repo-cdn.sigstage.dev] [32mPASSED[0m[33m                                                                                                                                                                    [ 53%][0m
test/unit/test_store.py::test_store_reads_targets_json[https://tuf-repo-cdn.sigstore.dev] [32mPASSED[0m[33m                                                                                                                                                                 [ 53%][0m
test/unit/test_store.py::test_store_reads_targets_json[https://tuf-repo-cdn.sigstage.dev] [32mPASSED[0m[33m                                                                                                                                                                 [ 53%][0m
test/unit/test_utils.py::test_key_id [32mPASSED[0m[33m                                                                                                                                                                                                                      [ 54%][0m
test/unit/test_utils.py::test_sha256_streaming[0] [32mPASSED[0m[33m                                                                                                                                                                                                         [ 54%][0m
test/unit/test_utils.py::test_sha256_streaming[1] [32mPASSED[0m[33m                                                                                                                                                                                                         [ 55%][0m
test/unit/test_utils.py::test_sha256_streaming[2] [32mPASSED[0m[33m                                                                                                                                                                                                         [ 55%][0m
test/unit/test_utils.py::test_sha256_streaming[4] [32mPASSED[0m[33m                                                                                                                                                                                                         [ 56%][0m
test/unit/test_utils.py::test_sha256_streaming[8] [32mPASSED[0m[33m                                                                                                                                                                                                         [ 56%][0m
test/unit/test_utils.py::test_sha256_streaming[32] [32mPASSED[0m[33m                                                                                                                                                                                                        [ 57%][0m
test/unit/test_utils.py::test_sha256_streaming[128] [32mPASSED[0m[33m                                                                                                                                                                                                       [ 57%][0m
test/unit/test_utils.py::test_sha256_streaming[1024] [32mPASSED[0m[33m                                                                                                                                                                                                      [ 58%][0m
test/unit/test_utils.py::test_sha256_streaming[131072] [32mPASSED[0m[33m                                                                                                                                                                                                    [ 58%][0m
test/unit/test_utils.py::test_sha256_streaming[1048576] [32mPASSED[0m[33m                                                                                                                                                                                                   [ 59%][0m
test/unit/test_utils.py::test_sha256_streaming[134217728] [32mPASSED[0m[33m                                                                                                                                                                                                 [ 59%][0m
test/unit/test_utils.py::test_load_pem_public_key_format [32mPASSED[0m[33m                                                                                                                                                                                                  [ 60%][0m
test/unit/test_utils.py::test_load_pem_public_key_serialization [32mPASSED[0m[33m                                                                                                                                                                                           [ 60%][0m
test/unit/test_utils.py::test_cert_is_ca[bogus-root.pem-True] [32mPASSED[0m[33m                                                                                                                                                                                             [ 60%][0m
test/unit/test_utils.py::test_cert_is_ca[bogus-intermediate.pem-True] [32mPASSED[0m[33m                                                                                                                                                                                     [ 61%][0m
test/unit/test_utils.py::test_cert_is_ca[bogus-leaf.pem-False] [32mPASSED[0m[33m                                                                                                                                                                                            [ 61%][0m
test/unit/test_utils.py::test_cert_is_ca_invalid_states[bogus-root-noncritical-bc.pem] [32mPASSED[0m[33m                                                                                                                                                                    [ 62%][0m
test/unit/test_utils.py::test_cert_is_ca_invalid_states[bogus-root-invalid-ku.pem] [32mPASSED[0m[33m                                                                                                                                                                        [ 62%][0m
test/unit/test_utils.py::test_cert_is_ca_invalid_states[bogus-root-missing-ku.pem] [32mPASSED[0m[33m                                                                                                                                                                        [ 63%][0m
test/unit/test_utils.py::test_cert_is_root_ca[bogus-root.pem-True] [32mPASSED[0m[33m                                                                                                                                                                                        [ 63%][0m
test/unit/test_utils.py::test_cert_is_root_ca[bogus-intermediate.pem-False] [32mPASSED[0m[33m                                                                                                                                                                               [ 64%][0m
test/unit/test_utils.py::test_cert_is_root_ca[bogus-leaf.pem-False] [32mPASSED[0m[33m                                                                                                                                                                                       [ 64%][0m
test/unit/test_utils.py::test_cert_is_root_ca[bogus-leaf-invalid-ku.pem-False] [32mPASSED[0m[33m                                                                                                                                                                            [ 65%][0m
test/unit/test_utils.py::test_cert_is_leaf[bogus-root.pem-False] [32mPASSED[0m[33m                                                                                                                                                                                          [ 65%][0m
test/unit/test_utils.py::test_cert_is_leaf[bogus-intermediate.pem-False] [32mPASSED[0m[33m                                                                                                                                                                                  [ 66%][0m
test/unit/test_utils.py::test_cert_is_leaf[bogus-intermediate-with-eku.pem-False] [32mPASSED[0m[33m                                                                                                                                                                         [ 66%][0m
test/unit/test_utils.py::test_cert_is_leaf[bogus-leaf.pem-True] [32mPASSED[0m[33m                                                                                                                                                                                           [ 66%][0m
test/unit/test_utils.py::test_cert_is_leaf[bogus-leaf-invalid-eku.pem-False] [32mPASSED[0m[33m                                                                                                                                                                              [ 67%][0m
test/unit/test_utils.py::test_cert_is_leaf_invalid_states[bogus-root-invalid-ku.pem] [32mPASSED[0m[33m                                                                                                                                                                      [ 67%][0m
test/unit/test_utils.py::test_cert_is_leaf_invalid_states[bogus-root-missing-ku.pem] [32mPASSED[0m[33m                                                                                                                                                                      [ 68%][0m
test/unit/test_utils.py::test_cert_is_leaf_invalid_states[bogus-leaf-invalid-ku.pem] [32mPASSED[0m[33m                                                                                                                                                                      [ 68%][0m
test/unit/test_utils.py::test_cert_is_leaf_invalid_states[bogus-leaf-missing-eku.pem] [32mPASSED[0m[33m                                                                                                                                                                     [ 69%][0m
test/unit/test_utils.py::test_cert_is_leaf_invalid_version[cert_is_leaf] [32mPASSED[0m[33m                                                                                                                                                                                  [ 69%][0m
test/unit/test_utils.py::test_cert_is_leaf_invalid_version[cert_is_ca] [32mPASSED[0m[33m                                                                                                                                                                                    [ 70%][0m
test/unit/test_utils.py::test_cert_is_leaf_invalid_version[cert_is_root_ca] [32mPASSED[0m[33m                                                                                                                                                                               [ 70%][0m
test/unit/test_version.py::test_version [32mPASSED[0m[33m                                                                                                                                                                                                                   [ 71%][0m
test/unit/verify/test_policy.py::TestVerificationPolicy::test_does_not_init [32mPASSED[0m[33m                                                                                                                                                                               [ 71%][0m
test/unit/verify/test_policy.py::TestUnsafeNoOp::test_succeeds [32mPASSED[0m[33m                                                                                                                                                                                            [ 72%][0m
test/unit/verify/test_policy.py::TestAnyOf::test_trivially_false [32mPASSED[0m[33m                                                                                                                                                                                          [ 72%][0m
test/unit/verify/test_policy.py::TestAnyOf::test_fails_no_children_match [32mPASSED[0m[33m                                                                                                                                                                                  [ 73%][0m
test/unit/verify/test_policy.py::TestAnyOf::test_succeeds [32mPASSED[0m[33m                                                                                                                                                                                                 [ 73%][0m
test/unit/verify/test_policy.py::TestAllOf::test_trivially_false [32mPASSED[0m[33m                                                                                                                                                                                          [ 73%][0m
test/unit/verify/test_policy.py::TestAllOf::test_certificate_extension_not_found [32mPASSED[0m[33m                                                                                                                                                                          [ 74%][0m
test/unit/verify/test_policy.py::TestAllOf::test_fails_not_all_children_match [32mPASSED[0m[33m                                                                                                                                                                             [ 74%][0m
test/unit/verify/test_policy.py::TestAllOf::test_succeeds [32mPASSED[0m[33m                                                                                                                                                                                                 [ 75%][0m
test/unit/verify/test_policy.py::TestIdentity::test_fails_no_san_match [32mPASSED[0m[33m                                                                                                                                                                                    [ 75%][0m
test/unit/verify/test_policy.py::TestSingleExtPolicy::test_succeeds [32mPASSED[0m[33m                                                                                                                                                                                       [ 76%][0m
test/unit/verify/test_verifier.py::test_verifier_production [32mPASSED[0m[33m                                                                                                                                                                                               [ 76%][0m
test/unit/verify/test_verifier.py::test_verifier_staging [32mPASSED[0m[33m                                                                                                                                                                                                  [ 77%][0m
test/unit/verify/test_verifier.py::test_verifier_one_verification [32mPASSED[0m[33m                                                                                                                                                                                         [ 77%][0m
test/unit/verify/test_verifier.py::test_verifier_inconsistent_log_entry [32mPASSED[0m[33m                                                                                                                                                                                   [ 78%][0m
test/unit/verify/test_verifier.py::test_verifier_multiple_verifications [32mPASSED[0m[33m                                                                                                                                                                                   [ 78%][0m
test/unit/verify/test_verifier.py::test_verifier_bundle[bundle.txt] [32mPASSED[0m[33m                                                                                                                                                                                       [ 79%][0m
test/unit/verify/test_verifier.py::test_verifier_bundle[bundle_v3.txt] [32mPASSED[0m[33m                                                                                                                                                                                    [ 79%][0m
test/unit/verify/test_verifier.py::test_verifier_bundle[bundle_v3_alt.txt] [32mPASSED[0m[33m                                                                                                                                                                                [ 80%][0m
test/unit/verify/test_verifier.py::test_verifier_bundle_offline[bundle.txt] [32mPASSED[0m[33m                                                                                                                                                                               [ 80%][0m
test/unit/verify/test_verifier.py::test_verifier_bundle_offline[bundle_v3.txt] [32mPASSED[0m[33m                                                                                                                                                                            [ 80%][0m
test/unit/verify/test_verifier.py::test_verifier_bundle_offline[bundle_v3_alt.txt] [32mPASSED[0m[33m                                                                                                                                                                        [ 81%][0m
test/unit/verify/test_verifier.py::test_verifier_email_identity [32mPASSED[0m[33m                                                                                                                                                                                           [ 81%][0m
test/unit/verify/test_verifier.py::test_verifier_uri_identity [32mPASSED[0m[33m                                                                                                                                                                                             [ 82%][0m
test/unit/verify/test_verifier.py::test_verifier_policy_check [32mPASSED[0m[33m                                                                                                                                                                                             [ 82%][0m
test/unit/verify/test_verifier.py::test_verifier_fail_expiry [33mXFAIL[0m[33m                                                                                                                                                                                               [ 83%][0m
test/unit/verify/test_verifier.py::test_verifier_dsse_roundtrip[preprod-staging] [32mPASSED[0m[33m                                                                                                                                                                          [ 83%][0m
test/unit/verify/test_verifier.py::test_verifier_dsse_roundtrip[preprod-local] [32mPASSED[0m[33m                                                                                                                                                                            [ 84%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_verifier_verify_timestamp [32mPASSED[0m[33m                                                                                                                                                              [ 84%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_verifier_no_validity_end [32mPASSED[0m[33m                                                                                                                                                               [ 85%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_vierifier_verify_no_inclusion_promise_and_integrated_time[fields_to_delete0] [32mPASSED[0m[33m                                                                                                           [ 85%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_vierifier_verify_no_inclusion_promise_and_integrated_time[fields_to_delete1] [32mPASSED[0m[33m                                                                                                           [ 86%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_vierifier_verify_no_inclusion_promise_and_integrated_time[fields_to_delete2] [33mXFAIL[0m[33m                                                                                                            [ 86%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_vierifier_verify_no_inclusion_promise_and_integrated_time[fields_to_delete3] [32mPASSED[0m[33m                                                                                                           [ 86%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_verifier_without_timestamp [32mPASSED[0m[33m                                                                                                                                                             [ 87%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_verifier_too_many_timestamp [32mPASSED[0m[33m                                                                                                                                                            [ 87%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_verifier_duplicate_timestamp [32mPASSED[0m[33m                                                                                                                                                           [ 88%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_verifier_outside_validity_range [32mPASSED[0m[33m                                                                                                                                                        [ 88%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_verifier_rfc3161_error [32mPASSED[0m[33m                                                                                                                                                                 [ 89%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_verifier_no_authorities [32mPASSED[0m[33m                                                                                                                                                                [ 89%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_late_timestamp [32mPASSED[0m[33m                                                                                                                                                                         [ 90%][0m
test/unit/verify/test_verifier.py::TestVerifierWithTimestamp::test_verifier_not_enough_timestamp [32mPASSED[0m[33m                                                                                                                                                          [ 90%][0m
test/integration/cli/test_attest.py::test_attest_success_default_output_bundle[https://slsa.dev/provenance/v0.2-slsa_predicate_v0_2.json] [32mPASSED[0m[33m                                                                                                                 [ 91%][0m
test/integration/cli/test_attest.py::test_attest_success_default_output_bundle[https://slsa.dev/provenance/v1-slsa_predicate_v1_0.json] [32mPASSED[0m[33m                                                                                                                   [ 91%][0m
test/integration/cli/test_attest.py::test_attest_success_custom_output_bundle [32mPASSED[0m[33m                                                                                                                                                                             [ 92%][0m
test/integration/cli/test_attest.py::test_attest_overwrite_existing_bundle [32mPASSED[0m[33m                                                                                                                                                                                [ 92%][0m
test/integration/cli/test_attest.py::test_attest_invalid_predicate_type [32mPASSED[0m[33m                                                                                                                                                                                   [ 93%][0m
test/integration/cli/test_attest.py::test_attest_mismatching_predicate [32mPASSED[0m[33m                                                                                                                                                                                    [ 93%][0m
test/integration/cli/test_attest.py::test_attest_missing_predicate [32mPASSED[0m[33m                                                                                                                                                                                        [ 93%][0m
test/integration/cli/test_attest.py::test_attest_invalid_json_predicate [32mPASSED[0m[33m                                                                                                                                                                                   [ 94%][0m
test/integration/cli/test_plumbing.py::test_fix_bundle_fixes_missing_checkpoint [32mPASSED[0m[33m                                                                                                                                                                           [ 94%][0m
test/integration/cli/test_plumbing.py::test_fix_bundle_upgrades_bundle [32mPASSED[0m[33m                                                                                                                                                                                    [ 95%][0m
test/integration/cli/test_sign.py::test_sign_success_default_output_bundle [32mPASSED[0m[33m                                                                                                                                                                                [ 95%][0m
test/integration/cli/test_sign.py::test_sign_success_custom_outputs [32mPASSED[0m[33m                                                                                                                                                                                       [ 96%][0m
test/integration/cli/test_sign.py::test_sign_success_custom_output_dir [32mPASSED[0m[33m                                                                                                                                                                                    [ 96%][0m
test/integration/cli/test_sign.py::test_sign_success_no_default_files [32mPASSED[0m[33m                                                                                                                                                                                     [ 97%][0m
test/integration/cli/test_sign.py::test_sign_overwrite_existing_bundle [32mPASSED[0m[33m                                                                                                                                                                                    [ 97%][0m
test/integration/cli/test_sign.py::test_sign_fails_with_default_files_and_bundle_options [32mPASSED[0m[33m                                                                                                                                                                  [ 98%][0m
test/integration/cli/test_sign.py::test_sign_fails_with_multiple_inputs_and_custom_output [32mPASSED[0m[33m                                                                                                                                                                 [ 98%][0m
test/integration/cli/test_sign.py::test_sign_fails_with_output_dir_and_custom_output_files [32mPASSED[0m[33m                                                                                                                                                                [ 99%][0m
test/integration/cli/test_sign.py::test_sign_fails_without_both_output_cert_and_signature [32mPASSED[0m[33m                                                                                                                                                                 [ 99%][0m
test/integration/cli/test_verify.py::test_regression_verify_legacy_bundle [32mPASSED[0m[33m                                                                                                                                                                                 [100%][0m

[33m=========================================================================================================================== warnings summary ===========================================================================================================================[0m
test/unit/internal/test_trust.py: 51 warnings
test/unit/test_sign.py: 60 warnings
test/unit/verify/test_verifier.py: 149 warnings
test/integration/cli/test_attest.py: 35 warnings
test/integration/cli/test_plumbing.py: 6 warnings
test/integration/cli/test_sign.py: 35 warnings
test/integration/cli/test_verify.py: 5 warnings
  /usr/local/google/home/rpetgrave/workspaces/rekorv2/.venv/lib/python3.13/site-packages/sigstore_protobuf_specs/dev/sigstore/trustroot/v1/__init__.py:139: DeprecationWarning: TransparencyLogInstance.log_id is deprecated
    warnings.warn(

test/unit/test_sign.py: 8 warnings
test/unit/verify/test_verifier.py: 2 warnings
  /usr/local/google/home/rpetgrave/workspaces/rekorv2/sigstore-python/sigstore/_internal/sct.py:176: UserWarning: Attribute's length must be >= 2 and <= 2, but it was 3
    _logger.debug(f"Found {cert.subject} as issuer, verifying if it is a ca")

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
============================================================================================================================ tests coverage ============================================================================================================================
___________________________________________________________________________________________________________ coverage: platform linux, python 3.13.2-final-0 ____________________________________________________________________________________________________________

Name                                     Stmts   Miss Branch BrPart  Cover
--------------------------------------------------------------------------
sigstore/__init__.py                         1      0      0      0   100%
sigstore/__main__.py                         3      3      2      0     0%
sigstore/_internal/__init__.py               3      0      0      0   100%
sigstore/_internal/fulcio/__init__.py        2      0      0      0   100%
sigstore/_internal/fulcio/client.py         84     21     10      2    69%
sigstore/_internal/merkle.py                42      2     10      2    92%
sigstore/_internal/oidc/__init__.py          0      0      0      0   100%
sigstore/_internal/oidc/oauth.py           100     25      8      1    70%
sigstore/_internal/rekor/__init__.py         8      0      0      0   100%
sigstore/_internal/rekor/checkpoint.py      86     12     22      9    81%
sigstore/_internal/rekor/client.py         106     25     12      3    73%
sigstore/_internal/sct.py                   86     16     22     11    75%
sigstore/_internal/timestamp.py             42      0      0      0   100%
sigstore/_internal/trust.py                264     16     62      8    92%
sigstore/_internal/tuf.py                   80      7     18      1    92%
sigstore/_store/__init__.py                  0      0      0      0   100%
sigstore/_utils.py                         111      6     30      2    94%
sigstore/dsse/__init__.py                  113     20     18      3    76%
sigstore/dsse/_predicate.py                 79      1      2      1    98%
sigstore/errors.py                          33     11      2      0    63%
sigstore/hashes.py                          21      2      4      2    84%
sigstore/models.py                         227     12     52     10    91%
sigstore/oidc.py                           132     27     30      3    77%
sigstore/sign.py                            93      4     12      4    92%
sigstore/verify/__init__.py                  3      0      0      0   100%
sigstore/verify/policy.py                  138      5     16      3    95%
sigstore/verify/verifier.py                165     15     44      7    89%
--------------------------------------------------------------------------
TOTAL                                     2022    230    376     72    86%
[36m[1m======================================================================================================================= short test summary info ========================================================================================================================[0m
[33mSKIPPED[0m [10] test/conftest.py:115: skipping test that requires a Timestamp Authority
[33m====================================================================================================== [32m203 passed[0m, [33m[1m10 skipped[0m, [33m[1m2 xfailed[0m, [33m[1m351 warnings[0m[33m in 26.98s[0m[33m =======================================================================================================[0m
Name                                     Stmts   Miss Branch BrPart  Cover   Missing
------------------------------------------------------------------------------------
sigstore/__init__.py                         1      0      0      0   100%
sigstore/__main__.py                         3      3      2      0     0%   19-22
sigstore/_internal/__init__.py               3      0      0      0   100%
sigstore/_internal/fulcio/__init__.py        2      0      0      0   100%
sigstore/_internal/fulcio/client.py         84     21     10      2    69%   113-115, 122-123, 128, 144-158, 195
sigstore/_internal/merkle.py                42      2     10      2    92%   107, 127
sigstore/_internal/oidc/__init__.py          0      0      0      0   100%
sigstore/_internal/oidc/oauth.py           100     25      8      1    70%   134, 137-166, 202, 234, 239, 243
sigstore/_internal/rekor/__init__.py         8      0      0      0   100%
sigstore/_internal/rekor/checkpoint.py      86     12     22      9    81%   77, 81, 99, 131, 140, 144, 153, 176, 184-185, 215, 229
sigstore/_internal/rekor/client.py         106     25     12      3    73%   56, 74-83, 101-106, 131, 136, 142-143, 160-161, 196-199, 210->208, 256
sigstore/_internal/sct.py                   86     16     22     11    75%   57-58, 61, 73, 82, 108, 147, 162-163, 168, 179-181, 202->222, 211, 216, 225
sigstore/_internal/timestamp.py             42      0      0      0   100%
sigstore/_internal/trust.py                264     16     62      8    92%   154, 181-191, 256, 316, 334, 347-348, 356, 366, 441, 465, 518, 571, 631
sigstore/_internal/tuf.py                   80      7     18      1    92%   123-124, 135, 140-144, 163-167
sigstore/_store/__init__.py                  0      0      0      0   100%
sigstore/_utils.py                         111      6     30      2    94%   42, 110-111, 114, 138-139
sigstore/dsse/__init__.py                  113     20     18      3    76%   94-98, 110-120, 180-181, 239, 292, 298-299
sigstore/dsse/_predicate.py                 79      1      2      1    98%   171
sigstore/errors.py                          33     11      2      0    63%   31, 36-49, 93-98, 110, 118
sigstore/hashes.py                          21      2      4      2    84%   49, 57
sigstore/models.py                         227     12     52     10    91%   188, 196, 309, 412, 477, 502, 509-510, 547, 549, 554, 634
sigstore/oidc.py                           132     27     30      3    77%   128-129, 213, 256-257, 269-270, 297, 307-315, 339-340, 349-354, 365, 369-397, 411-412
sigstore/sign.py                            93      4     12      4    92%   103->exit, 113-114, 130, 136
sigstore/verify/__init__.py                  3      0      0      0   100%
sigstore/verify/policy.py                  138      5     16      3    95%   126-127, 136, 347, 454, 461->465
sigstore/verify/verifier.py                165     15     44      7    89%   261-262, 336-337, 343, 347, 370, 404, 425-426, 433, 435, 448, 485-486
------------------------------------------------------------------------------------
TOTAL                                     2022    230    376     72    86%
